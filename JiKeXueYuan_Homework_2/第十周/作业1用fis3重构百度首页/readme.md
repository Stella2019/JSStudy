
##开发环境
###软件版本
|软件|操作系统|nodejs|fis|
|---|---|---|---|---|
|版本|OS X 10.11.2|v4.2.3|v3.3.13|

###所需要的依赖：
1. fis-optimizer-html-minifier
2. fis3-hook-cmd
3. fis3-postpackager-loader

##关于作业说明
基本的思路是，将项目的文件分为静态资源和页面资源。（本来应该把seajs依赖的html代码也搞成静态资源，但这样做就只剩一个index页面了，太少了，为了练习就把依赖的html也做为页面处理啦）
‘moreVideodata.html’是一个特殊情况，这个文件是模拟ajax返回json数据的。所以这个文件就当做单另的处理了。
源文件结构：
```
root
|-index                 //由于index页面也是模块化的，使用到的组成页面的模块都存在这里
|-module                //保存了可以公共的模块
|-seajs                 //seajs相关文件
|-node_modules          //nodejs模块和依赖
|-index.html            //首页
|-moreVideodata.html    //ajax数据模拟
|-package.json          //nodejs配置信息
|-fis-conf.js           //fis项目流程配置
```
导出的目录是按照如下规则导出：
```
root
|-version               //这个版本也可以去掉，我理解依据具体的项目情况来设置。
   |-js                 //所有的js文件
   |-css                //所有的CSS文件
   |-htmls              //所有的html文件
   |-images             //所有的图片文件
   |-index.html         //首页
   |-moreVideodata.html //ajax数据模拟
```
所有的静态文件均打上了hash码，包括JS，CSS，图像文件。
所有的CSS和JS文件均进行了压缩操作。
部署的建议采用releas命令输出到自己希望的文件夹下。如：
```
fis3 release -d ../dist
```  
将输出的文件夹作为网站的根目录，按照上面的例子请将dist文件夹作为网站根目录。然后访问下面的链接即可：
```
http://[your server ip]/[version in your fis config file]/
```
在我的机器上是：
```
http://127.0.0.1/1.0.0/index.html
```
编译部署后的代码可以正常运行，除了'moreVideodata.html'中的资源外，应该没有404问题。
**本次作业除了对在JS中的静态资源设置了__uri()，和将index.html中的seajs.config移到了fis-config中，其他的代码均未做修改。**

本来可以设计依据media来修改deploy部署策略的，如测试版本，上线版本，开发中间版本的。但是我理解这个已经不是困难的。而理解“工程”这两个字才是困难的。
因此有了下面的文字。

##本次作业写得特别困扰。
在对FIS的文档，和部分插件的代码研磨之后，还是完成了当前的作业，但是还是有很多对于FIS的困扰。
目前留下的最大的遗憾是没有对JS和CSS进行打包处理。

以下是一些我在此次作业中的理解，还望老师能够帮忙解惑。
1. 我理解seajs是一个纯前端的模块化框架。是不是现在的项目不优先使用这种纯前端的模块化框架，而是采用一些需要后端编译的后端模块框架？  
我理解在FIS中使用纯前端框架的问题  
    1.1 seajs有自己的依赖分析，提供require在浏览器动态请求依赖。但如果要在工作流中使用，需要工作流去识别seajs中的各项依赖，并正确的部署，在这其中会遇到较多的问题。不如后端的模块化直接有自己的依赖分析来的准确直观。  
    1.2 后端模块化，必须经过编译后才能运行，而seajs在开发时无需编译就可以运行。  
    1.3 FIS和seaj配合下，为了适配FIS，需要修改js文件中的资源文件地址，加上__uri(),但这样seajs项目无法在编译前运行,必须编译后才能运行。  

2. FIS有些太黑盒了，总让人琢磨不透他内部到底怎么个规律运作的。很多插件也不知道会出现什么结果。我在配合Seajs时，这些插件总是不能按照我理想的情况运行。
3. 由于上面的情况，在插件实在不能满意的情况下，自己按照规则写了一个适配自己项目预期的代码（可以包成插件，作业中没有包成插件而是直接内嵌在fis-config文件中了。）但是FIS写代码的调试太痛苦了。
4. 另外发现一个不能理解的情况，即在使用FIS的cmd模块后，seajs的require似乎行为有变化，无法发出对于HTML和CSS的请求。必须将请求的html和CSS写在difine中才可以。也可能是没有真正理解FIS和CMD吧。
5. 本来在这个项目中想使用打包插件来打包所有的CSS和JS文件，但是最终还是放弃了，主要原因是打包后，seajs的require的资源没有重定向。（其实还是因为过于黑盒，无法知道问题在哪里，也没有找到相关的插件可以解决这个问题。）

不过我理解FIS正真的核心是下面这张图展示的流程。其实FIS是构建了这样一个流程，然后用户可以在这个流程中个各个节点做自己想做的事情。
https://raw.githubusercontent.com/fex-team/fis3/master/doc/docs/api/img/fis-compile-flow.png  
在理解了上面这个流程，其实很多东西都可以自己写，虽然工作量大，但是可更加匹配自己的项目，而不必为插件的行为而苦恼。



